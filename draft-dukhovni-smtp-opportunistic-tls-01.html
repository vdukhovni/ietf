<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>SMTP security via opportunistic DANE TLS</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Background"/>
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 SMTP Channel Security"/>
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Terminology"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Hardening Opportunistic TLS"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 TLS discovery"/>
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 DANE authentication"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Opportunistic TLS for Submission"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Mandatory TLS Security"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Acknowledgements"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations"/>
<link href="#rfc.references" rel="Chapter" title="7 Normative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Dukhovni, V. and W.H. Hardaker" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-dukhovni-smtp-opportunistic-tls-01" />
  <meta name="dct.issued" scheme="ISO8601" content="2013-7-06" />
  <meta name="dct.abstract" content="This memo describes a protocol for opportunistic TLS security based on the DANE TLSA DNS record.  The design goal is an incremental transition of the Internet email backbone (MTA to MTA SMTP traffic) from today's unauthenticated and typically unencrypted connections to TLS encrypted and authenticated delivery when the client is DANE TLSA aware and the server domain publishes DANE TLSA records for its MX hosts.  This protocol is being implemented by multiple MTA software packages.  " />
  <meta name="description" content="This memo describes a protocol for opportunistic TLS security based on the DANE TLSA DNS record.  The design goal is an incremental transition of the Internet email backbone (MTA to MTA SMTP traffic) from today's unauthenticated and typically unencrypted connections to TLS encrypted and authenticated delivery when the client is DANE TLSA aware and the server domain publishes DANE TLSA records for its MX hosts.  This protocol is being implemented by multiple MTA software packages.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">DANE</td>
  <td class="right">V. Dukhovni</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Unaffiliated</td>
</tr>
<tr>
  <td class="left">Intended status: Experimental</td>
  <td class="right">W.H. Hardaker</td>
</tr>
<tr>
  <td class="left">Expires: January 07, 2014</td>
  <td class="right">Parsons</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">July 06, 2013</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">SMTP security via opportunistic DANE TLS<br />
  <span class="filename">draft-dukhovni-smtp-opportunistic-tls-01</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This memo describes a protocol for opportunistic TLS security based on the DANE TLSA DNS record.  The design goal is an incremental transition of the Internet email backbone (MTA to MTA SMTP traffic) from today's unauthenticated and typically unencrypted connections to TLS encrypted and authenticated delivery when the client is DANE TLSA aware and the server domain publishes DANE TLSA records for its MX hosts.  This protocol is being implemented by multiple MTA software packages.  </p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 07, 2014.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2013 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>1.1.   <a href="#rfc.section.1.1">Background</a></li>
<li>1.2.   <a href="#rfc.section.1.2">SMTP Channel Security</a></li>
<li>1.3.   <a href="#rfc.section.1.3">Terminology</a></li>
<li>2.   <a href="#rfc.section.2">Hardening Opportunistic TLS</a></li>
<li>2.1.   <a href="#rfc.section.2.1">TLS discovery</a></li>
<li>2.2.   <a href="#rfc.section.2.2">DANE authentication</a></li>
<li>3.   <a href="#rfc.section.3">Opportunistic TLS for Submission</a></li>
<li>4.   <a href="#rfc.section.4">Mandatory TLS Security</a></li>
<li>5.   <a href="#rfc.section.5">Acknowledgements</a></li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a></li>
<li>7.   <a href="#rfc.references">Normative References</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> Introduction</h1>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> Background</h1>
<p id="rfc.section.1.1.p.1">The Domain Name System Security Extensions (DNSSEC) add data origin authentication and data integrity to the Domain Name System.  DNSSEC is defined in <a href="#RFC4033">[RFC4033]</a>, <a href="#RFC4034">[RFC4034]</a> and <a href="#RFC4035">[RFC4035]</a>.  </p>
<p id="rfc.section.1.1.p.2">As described in the introduction of <a href="#RFC6698">[RFC6698]</a>, TLS authentication via the existing public CA PKI suffers from an over-abundance of trusted certificate authorities capable of issuing certificates for any domain of their choice.  DNS-Based Authentication of Named Entities (DANE) leverages the DNSSEC infrastructure to publish trusted keys and certificates (or hashed references to them) for use with TLS via a new TLSA record type.  DNSSEC validated DANE TLSA records yield a new PKI designed to augment or replace the trust model of the existing public CA PKI.  </p>
<p id="rfc.section.1.1.p.3">In the context of this memo channel security is assumed to be provided by TLS.  The Transport Layer Security (TLS) protocol provides communications privacy over the Internet.  Used without authentication, TLS provides protection only against eavesdropping.  With authentication, TLS also provides protection against man-in-the-middle (MITM) attacks.  Since the publication of the TLS 1.0 specification in <a href="#RFC2246">[RFC2246]</a>, two updates to the protocol have been published: TLS 1.1 <a href="#RFC4346">[RFC4346]</a> and TLS 1.2 <a href="#RFC5246">[RFC5246]</a>.  </p>
<h1 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> SMTP Channel Security</h1>
<p id="rfc.section.1.2.p.1">SMTP is multi-hop store &amp; forward, while TLS security is hop-by-hop.  The number of hops from the sender to the recipient mailbox is rarely less than 3 and is often higher.  Some hops may be TLS protected, some may not.  The same SMTP TCP endpoint can serve both TLS and non-TLS clients, with TLS negotiated via the SMTP STARTTLS command (<a href="#RFC3207">[RFC3207]</a>).  MX RRs abstract hop destinations via DNS.  SMTP addresses are not transport addresses and are security agnostic.  Unlike HTTP, there is no URI scheme for email addresses to designate SMTP vs. SMTPS addresses.  </p>
<p id="rfc.section.1.2.p.2">An MTA may need to forward a message to a particular email recipient &lt;user@example.com&gt;.  To deliver the message the MTA needs to retrieve the MX hosts of example.com from DNS, and then deliver the message to one of these.  Absent DNSSEC, the MX lookup is vulnerable to man-in-the-middle and cache poisoning attacks.  As a result, verifying MX host certificates without using DNSSEC is futile as the attacker can simply forge DNS replies and issue bogus MX records, directing traffic to a server of his choice.  </p>
<p id="rfc.section.1.2.p.3">One might try to harden STARTTLS with SMTP against DNS attacks by requiring each MX host to posess an X.509 certificate for the recipient domain that is obtained from the message envelope and is not subject to DNS reply forgery.  Unfortunately, this is impractical, as email for many domains is handled by third parties, which are not in a position to obtain certificates for all the domains they serve.  Deployment of SNI (see <a href="#RFC3546">[RFC3546]</a> Section 3.1) is no panacea, since the key management is operationally challenging at large scale unless the email service provider is also the domain's registrar and its certificate issuer; this is rarely the case for email.  </p>
<p id="rfc.section.1.2.p.4">A man-in-the-middle can also suppress the MX host's STARTTLS EHLO response.  Unless the sending MTA is statically configured to use TLS for mail sent to example.com, the message will be sent unauthenticated and in the clear.  Sender-side configuration of peer-domains for which TLS must be used can protect an organization and a few of its business partners, but is not a viable approach to securing the Internet email backbone.  Internet email requires contacting many new domains for which security configurations can not be established in advance.  </p>
<p id="rfc.section.1.2.p.5">Since with the existing public CA PKI neither the recipient domain, nor the MX hostname are suitable SMTP server authentication identities, large scale deployment of authenticated TLS based on this PKI is not possible in the context of MTA to MTA SMTP.  SMTP secure channels authenticated via the public CA PKI are used by a handful of domains that make bilateral arrangements with their business partners.  At this time, MTA to MTA traffic between Internet connected organizations typically does not use TLS at all, or uses TLS opportunistically without authentication, for protection only against passive eavesdropping.  </p>
<p id="rfc.section.1.2.p.6">Note, the above does not apply to submission <a href="#RFC6409">[RFC6409]</a>, where a mail user agent is pre-configured to send all email to a fixed MSA.  Submission servers typically offer TLS and the MUA can be statically configured to use TLS with its chosen MSA.  The situation changes when submission servers are configured dynamically via SRV records (see <a href="#RFC6186">[RFC6186]</a> Section 6, this is not yet widely deployed).  We'll discuss applications to submission via SRV records later in this memo.  </p>
<p id="rfc.section.1.2.p.7">With little opportunity to use the existing public CA PKI, MX hosts that support STARTTLS often use self-signed or private-CA issued X.509 certificates.  They are generally not configured with a comprehensive list of trusted CAs and do not check CRLs or implement OCSP.  In essence they don't and can't use the existing public CA PKI.  This is not simply a result of complacency on the part SMTP server administrators and MTA developers.  Nor is it just a result of the relative maturity of the SMTP infrastructure (as compared to the then young HTTP) when TLS was introduced.  Rather, as we've explained, the abstraction of the SMTP transport endpoint via DNS MX records, often across organization boundaries, limits the use of public CA PKI with SMTP to a small set of sender-configured peer domains.  </p>
<p id="rfc.section.1.2.p.8">This does not mean that the Internet email backbone cannot benefit from TLS.  The fact that transport security is not explicitly specified in either the recipient address or the MX record means that new protocols can furnish out-of-band information to SMTP, making it possible to discover both which peer domains support secure delivery via TLS and simultaneously how to verify the authenticity of the associated MX hosts.  The first such mechanism that can work an Internet scale is DANE TLSA, but use of DANE TLSA with MTA to MTA SMTP must be cognizant of the lack of any realistic role for the existing public CA PKI.  </p>
<h1 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a> Terminology</h1>
<p id="rfc.section.1.3.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> Hardening Opportunistic TLS</h1>
<p id="rfc.section.2.p.1">This section describes opportunistic TLS security, where traffic from DANE TLSA aware SMTP clients to domains that implement DANE TLSA records in accordance with this memo is secure, while traffic to other domains continues to be sent in the same manner as before.  It is hoped that over time more domains will implement DNSSEC and publish DANE TLSA records for their MX hosts.  This will enable an incremental transition of the email backbobe to authenticated TLS delivery.  </p>
<p id="rfc.section.2.p.2">Since email addresses and MX hostnames (or submission SRV records) neither signal nor deny support for TLS by the receiving domain, it is possible to use DANE TLSA records to securely signal TLS support and simultaneously to provide the means by which SMTP clients can successfully authenticate legitimate SMTP servers.  </p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> TLS discovery</h1>
<p id="rfc.section.2.1.p.1">As noted previously, opportunistic TLS with SMTP servers that advertise TLS support via STARTTLS is subject to a man in the middle downgrade attack.  Some SMTP servers erroneously advertise STARTTLS in default configurations that are not in fact TLS capable, and clients need to be prepared to retry plaintext delivery after STARTTLS fails.  Below we specify downgrade resistant mechanism for a server to advertise TLS support via DNSSEC validated DANE TLSA records.  DNSSEC validated TLSA records are unlikely to be published by default for servers that do not in fact support TLS, and thus clients can safely interpret their presence as a commitment by the server operator to implement STARTTLS.  </p>
<p id="rfc.section.2.1.p.2">SMTP is a store &amp; forward protocol.  An MTA that is not the final destination for a message recipient forwards the message one hop closer to the recipient's mailbox.  To do so it must determine the appropriate next-hop destination.  </p>
<p id="rfc.section.2.1.p.3">Typically, the next-hop destination defaults to the domain part of the recipient address which is then subject to MX resolution.  The next-hop destination may be configured by the MTA administrator to be a next-hop destination host (explicitly exempt from MX resolution), or a next-hop destination domain (subject to MX resolution) which takes the place of the domain part of the recipient address.  In the language of <a href="#RFC5321">[RFC5321]</a> Section 5.1, we'll refer to this next-hop destination host or domain as "the initial name".  </p>
<h1 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a> MX resolution</h1>
<p id="rfc.section.2.1.1.p.1">If the initial name is a next-hop host not subject to MX resolution, it is resolved to one or more network addresses, by performing DNSSEC validated "A" and/or "AAAA" lookups.  If it is a next-hop domain that is subject to MX resolution, a DNSSEC validated "MX" lookup is performed instead.  </p>
<p id="rfc.section.2.1.1.p.2">Following <a href="#RFC5321">[RFC5321]</a> Section 5.1, if the "A", "AAAA" or "MX" lookup of the initial name yields a CNAME, we replace it with the resulting name as if it were the initial name and try the same lookup again with the new name.  Many MTAs support limited recursion in CNAME expansion in which case the replacement is performed recursively.  If at any stage of recursion the response is "bogus" next-hop resolution fails with a temporary error.  Mail delivery SHOULD either be deferred or attempted via any alternative delivery channel configured by the MTA administrator (which may also employ opportunistic DANE TLS).  </p>
<p id="rfc.section.2.1.1.p.3">If at any stage the response is "insecure", opportunistic DANE TLS is not applicable, and mail delivery SHOULD proceed with pre-DANE opportunistic TLS (subject to its various MITM attacks).  </p>
<p id="rfc.section.2.1.1.p.4">If at each and every stage the respose is "secure", and the initial name is a next-hop host name not subject to MX resolution, the resulting final name becomes the next-hop destination and is the base domain for TLSA record lookup.  </p>
<p id="rfc.section.2.1.1.p.5">If at each and every stage the respose is "secure", and the initial name is a next-hop domain subject to MX resolution, and no MX records are found, the resulting final name is the next-hop destination and is the base domain for TLSA record lookup.  </p>
<p id="rfc.section.2.1.1.p.6">If at each and every stage the respose is "secure", and the initial name is a next-hop domain subject to MX resolution, and one or more MX records are found, the MX records MUST be sorted by preference.  A better (numerically lower) MX preference for a host that does not support TLS MUST NOT be preempted by a worse (numerically higher) MX preference for a host that does support TLS.  In other words, avoiding delivery loops trumps any preference for channel security.  </p>
<p id="rfc.section.2.1.1.p.7">In each delivery attempt via a candidate MX host, the MX host SHOULD be treated as though it were the initial next-hop destination host (which is, of course, not subject to further MX resolution) with the associated TLSA base domain determined as above.  </p>
<p id="rfc.section.2.1.1.p.8">CNAMEs are not legal in the value domain of MX records, thus MTAs MAY skip over MX records in which the MX host is a CNAME.  There is some additional risk in that case that the MTA may fail to notice that it is one of the MX hosts for the destination and that it must skip MX records with equal or worse (numerically higher precedence).  If an MTA does allow CNAMEs to be used in MX records it SHOULD process them recursively as described above to determine whether opportunistic DANE TLS is applicable and if so the associated TLSA RRset base domain.  </p>
<h1 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a> TLSA record lookup</h1>
<p id="rfc.section.2.1.2.p.1">When all the DNSSEC lookups, "CNAME", "MX", "A" or "AAAA", used to obtain a given TLSA base domain (one for each candidate MX host if multiple DNSSEC validated MX hosts were found) is "secure", and the SMTP client is configured for opportunistic DANE TLS, it SHOULD locate the TLSA RRset corresponding to this base domain.   If, for example, the base domain is "mail.example.com", the TLSA RRset is obtained via a DNSSEC query of the form: </p>
<pre>
_25._tcp.mail.example.com. IN TLSA ?
</pre>
<p class="figure"></p>
<p id="rfc.section.2.1.2.p.2">Typically, the destination TCP port is 25, but this may be different with custom routes specified by the MTA administrator or when an MSA connects to a submission server on port 587.  The SMTP client MUST use the appropriate "_&lt;port&gt;" prefix in place of "_25" when the port number is not equal to 25.  The query response may be a CNAME (or a DNAME + CNAME combination), or the TLSA RRset.  DNAME processing with DNSSEC is not SMTP-specific and will not be discussed in detail here.  The SMTP client MUST check the security status of the response.  </p>
<p id="rfc.section.2.1.2.p.3">If the response is "bogus", delivery via the host in question SHOULD NOT proceed, otherwise the SMTP client is vulnerable to man in the middle STARTTLS downgrade attacks.  If the response is "insecure", opportunistic DANE TLS is not applicable for the host in question, and the SMTP client SHOULD proceed with legacy opportunistic TLS.  If the response is "secure" and the record is a CNAME or DNAME, the SMTP client restarts the TLSA query at the target domain (CNAMES should not recurse, but the client MAY support CNAME recursion with a sensible depth limit).  </p>
<p id="rfc.section.2.1.2.p.4">If, after possible CNAME indirection, the response is "secure" and at least one TLSA record is found (even if not usable, that is either unsupported by the implementation or administratively disabled) the next-hop host has committed to TLS support.  The SMTP client SHOULD NOT deliver mail via such a next-hop host unless a TLS session is negotiated via STARTTLS.  This avoids man in the middle STARTTLS downgrade attacks.  </p>
<p id="rfc.section.2.1.2.p.5">When usable TLSA records are available, a client SHOULD NOT deliver mail via a server that fails to match at least one TLSA record.  </p>
<p id="rfc.section.2.1.2.p.6">We say SHOULD not MUST in the case of the client, since clients may incrementally deploy opportunistic DANE TLS only for selected peer domains.  At times clients may need to disable opportunistic DANE TLS for peers that fail to interoperate due to misconfiguration or software defects on either end.  For opportunistc DANE TLS to be a robust protocol, servers MUST live up to their promises, but it is not possible to compel clients to use a security policy chosen by the server.  We expect that given a robust security protocol, clients will over time willingly choose to adopt it.  </p>
<p id="rfc.section.2.1.2.p.7">The party responsible for creating TLSA records for a given service MUST ensure that at least one of these TLSA records will match either the server's default certificate chain if SNI is not employed on the server, or the server's certificate chain when the client signals the base domain of the TLSA RRset via SNI and a name type of "host_name" (<a href="#RFC3546">[RFC3546]</a> Section 3.1).  </p>
<p id="rfc.section.2.1.2.p.8">When, for example, the TLSA RRset is published at _25._tcp.mail.example.com the base domain is mail.example.com.  At least one of the TLSA records in the RRset MUST match the server certificate chain, provided the SMTP client's TLS hanshake included the SNI extension with a domain of mail.example.com.  </p>
<p id="rfc.section.2.1.2.p.9">Complications arise when TLSA records for a service are created by someone other than the server operator.  In this situation the server operator and TLSA record creator must cooperate to ensure that TLSA records don't fall out of step with the server certificate configuration.  </p>
<p id="rfc.section.2.1.2.p.10">When the server operator is a hosting provider, the customer's MX records should contain the primary hostnames of the provider's SMTP servers.  This way, any associated TLSA records will be found in the hosting provider's DNSSEC zone, thus avoiding the complexity of bilateral coordination of server certificate configuration and TLSA record management.  If the customer's DNS zone is signed, the provider hostnames in customer domain's MX records can be securely used as the base names for locating TLSA records managed by the hosting provider.  </p>
<p id="rfc.section.2.1.2.p.11">Redirection of SMTP service from one domain to another is usually accomplished via MX records (or perhaps SRV records in the case of submission).  Alternatively, the domain part of an email address may be a CNAME (see <a href="#RFC5321">[RFC5321]</a> Section 2.3.5).  CNAMEs are a more blunt instrument for this purpose, since unlike MX or SRV records they remap the origin domain to the target domain for all protocols.  Also Unlike MX or SRV records CNAME records may chain (though clients will generally impose implementation dependent maximum nesting depths).  </p>
<p id="rfc.section.2.1.2.p.12">Though CNAMEs are illegal on the right hand side of MX and SRV records, they are supported by some SMTP software.  They arise most frequently with submission clients or when an administrator configures an explicit next-hop destination host and that host happens to be an alias.  If the MX or SRV host is a CNAME alias from a customer's domain to a server in the provider's domain, the client SHOULD follow the CNAME and SHOULD use the target hostname as the base domain for TLSA records as well as the host_name in SNI.  </p>
<p id="rfc.section.2.1.2.p.13">Treating CNAMEs in MX hosts in the same manner as CNAMEs with non-MX destinations is consistent with <a href="#RFC5321">[RFC5321]</a> where non-MX destinations are considered equivalent to destinations with a single preference 0 MX record with the query domain identical to the MX host.  </p>
<p id="rfc.section.2.1.2.p.14">When CNAMEs are employed the sensible place to seek DANE TLSA records is in the provider's domain, as the provider knows best which certificates are deployed on the server.  Therefore, clients implementing opportunistic DANE TLS when connecting to a server whose DNS name is a CNAME SHOULD follow the CNAME hop-by-hop to its ultimate target host (noting at each step whether the CNAME is DNSSEC validated) and use the resulting target host as the base domain for TLSA lookups.  </p>
<p id="rfc.section.2.1.2.p.15">If CNAMEs were not followed, to support DANE validation the origin domain would have to publish TLSA records that match the server certificate chain.  Since the origin domain may not administer the server this imposes a difficult key management burden on the provider and customer even with SNI.  </p>
<p id="rfc.section.2.1.2.p.16">Accordingly, TLSA records SHOULD NOT be published for a base domain that is a CNAME.  Such TLSA records may not reliably verify, and SHOULD NOT be used by opportunistic SMTP DANE TLS clients.  </p>
<p id="rfc.section.2.1.2.p.17">It may be tempting to publish CNAMEs in the hosted domain pointing to the provider's TLSA RRset.  This only works when the provider's TLSA RRs specify certificate usage 3.  Otherwise, an SMTP client that used the alias name (from the hosted rather than the provider's domain) as the base domain to obtain the TLSA RRset would look for the hosted domain in the server certificate when performing name checks, and would generally fail to authenticate the server except in the rare cases when the server's certificate does include the hosted domain.  </p>
<pre>
; TLSA RRs aliased to provider, but the base domain is the hosted
; domain.  Likely to fail name check unless provider usage is "3".
;
_25._tcp.mail.example.com. IN CNAME _25._tcp.mail.example.net.
</pre>
<p class="figure"></p>
<h1 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a> DANE authentication</h1>
<h1 id="rfc.section.2.2.1"><a href="#rfc.section.2.2.1">2.2.1.</a> TLSA certificate usages</h1>
<p id="rfc.section.2.2.1.p.1">As noted in the introduction, the existing public CA PKI is not viable for the Internet email backbone.  TLSA records for MX hosts or submission servers that are to be found via SRV records SHOULD NOT include certificate usage "0" or "1", as in both cases SMTP clients cannot be expected to perform <a href="#RFC5280">[RFC5280]</a> PKIX validation or <a href="#RFC6125">[RFC6125]</a> identity verification.  </p>
<p id="rfc.section.2.2.1.p.2">If despite this recommendation SMTP servers do publish TLSA records with certificate usage "0" or "1", clients SHOULD make use of these to the fullest extent possible.  </p>
<p id="rfc.section.2.2.1.p.3">With any of the certificate usages described below server operators should generally avoid publishing "TLSA ? 0 0" records as even a single certificate is generally too large to be reliably delivered via DNS.  Two full certificates may need to be published in the TLSA RRset for certificate rollover.  </p>
<p id="rfc.section.2.2.1.p.4">While "TLSA ? 1 0" records that publish full public keys are generally more compact, these too should be used with caution, for example two 2048-bit RSA keys require more than 512 bytes of DNS data, and thus don't fit into the default 512-byte limit for DNS UDP replies.  Servers SHOULD publish the certificate or key digest via DNS, with the complete key or certificate communicated in band during the TLS handshake.  </p>
<h1 id="rfc.section.2.2.1.1"><a href="#rfc.section.2.2.1.1">2.2.1.1.</a> Certificate usage 3</h1>
<p id="rfc.section.2.2.1.1.p.1">Since opportunistic DANE TLS will be used by non-interactive MTAs, with no user to "press OK" when authentication fails, reliability of peer authentication is paramount.  The recommended choice of TLSA record type for opportunistic DANE TLS is "3 1 1".  This record specifies the SHA-256 digest of the server's public key.  </p>
<p id="rfc.section.2.2.1.1.p.2">Authentication via certificate usage "3" TLSA records involves no certificate authority signature checks as no CA is explicitly trusted.  It also involves no server name checks, and thus does not a impose any new requirements on the names contained in the server certificate (SNI not required when the TLSA record matches the public key of the server's default certificate).  It uses the SHA-256 digest which all clients are obligated to support, and works across certificate renewals with the same key.  TLSA records for SMTP servers SHOULD typically be "3 1 1" records.  </p>
<p id="rfc.section.2.2.1.1.p.3">Two such records need to be published before updating the server's public key, one matching the currently deployed key and the other matching the new key scheduled to replace it.  Once sufficient time has elapsed for all caches to time out the previous TLSA RRset which contains only the old key the server may be reconfigured to use the new private key and associated public key certificate.  The zone signature validity time provides an upper bound on the time required).  Once the server is using a new key, the obsolete TLSA RR can be removed from DNS, leaving only the RR that matches the new key.  </p>
<h1 id="rfc.section.2.2.1.2"><a href="#rfc.section.2.2.1.2">2.2.1.2.</a> Certificate usage 2</h1>
<p id="rfc.section.2.2.1.2.p.1">Some domains may prefer to reduce the operational complexity of publishing unique TLSA RRs for each TLS service.  If the domain employs a common issuing certificate authority to create certificates for multiple TLS services, it may be simpler to publish the issuing authority's public key as a trust-anchor for the certificate chains of all relevant services.  The TLSA RRs for each service issued by the same TA may then be CNAMEs to a common TLSA RRset that matches the TA.  In this case, the TLS handshake trust chain of each service SHOULD include the TA certificate, as SMTP clients cannot generally be expected to have domain-issued trust-anchor certificates in their trusted certificate store.  The recommended record type in this case is either "2 1 1" or "2 0 1", which specifies the SHA-256 digest of the trust-anchor public key or certificate.  Two such TLSA RRs need to be published to facilitate TA certificate rollover.  </p>
<p id="rfc.section.2.2.1.2.p.2">The usability of "2 1 1" or "2 0 1" TLSA RRs with SMTP is not assured.  If server operators emplying these RRs almost universally ensure that the corresponding TA certificate is included in the SMTP server's TLS handshake trust chain, then clients will enable support for these RRs.  If sufficiently many server administrators are negligent in deploying these RRs, SMTP clients may be hesitant to support them since mail delivery will not work to many destination domains if they do.  We encourage server operators to implement these RRs if appropriate to their organization, provided they do so with care.  Never forget to include trust-anchor certificates in server trust chains.  We encourage SMTP client implementations to support these TLSA RRs by default, unless future experience proves our optimism unfounded.  </p>
<p id="rfc.section.2.2.1.2.p.3">Clients employing opportunistic DANE TLS MAY choose to treat any TLSA records with certificate usage "0" as unusable.  They may then choose to connect via unauthenticated mandatory TLS if no alternative authentication mechanisms are available.  </p>
<h1 id="rfc.section.2.2.1.3"><a href="#rfc.section.2.2.1.3">2.2.1.3.</a> Certificate usage 1</h1>
<p id="rfc.section.2.2.1.3.p.1">SMTP servers SHOULD NOT publish TLSA RRs with certificate usage "1".  SMTP clients that implement this specification SHOULD ignore the PKIX validation requirement when they encounter certificate usage "1", and SHOULD authenticate the server per the content of the TLSA record alone.  That is, as with certificate usage "3", clients SHOULD NOT apply name checks, expiration checks, or process the server certificate content beyond possibly extracting its public key for matching against corresponding TLSA RRs.  </p>
<h1 id="rfc.section.2.2.1.4"><a href="#rfc.section.2.2.1.4">2.2.1.4.</a> Certificate usage 0</h1>
<p id="rfc.section.2.2.1.4.p.1">SMTP servers SHOULD NOT publish TLSA RRs with certificate usage "0".  Since PKIX validation is not possible with opportunistic DANE TLS, SMTP clients SHOULD treat certificate usage "0" RRs as though they were certificate usage "2" RRs, but with certificate usage "0" the usability of the TLSA record depends more strongly on its matching type.  Name checks, key usage checks, ... apply identically to the leaf certificate with TLSA usages "0" and "2".  </p>
<p id="rfc.section.2.2.1.4.p.2">If the matching type is "0" (the server also avoid this matching type and should publish usage "3" or "2" public key or certificate digests) the TLSA record contains the full certificate or full public key of the trusted certificate authority.  In this case the client has all the information it needs to match the server trust-chain to the TLSA record.  The client SHOULD in this case ignore the PKIX validation requirement, and verify the server's trust chain via its DANE TLSA records only (name checks still apply as with usage "2").  </p>
<p id="rfc.section.2.2.1.4.p.3">If the matching type is not "0", the TLSA record contains only a digest of the trust certificate authority certificate or public key.  The server operator publishing usage 0 TLSA records may expect that clients already have the issuing authority certificate on hand, and may omit it from the server's certificate chain.  As a result the client may not be able to match the server trust chain against the TLSA record.  </p>
<p id="rfc.section.2.2.1.4.p.4">SMTP clients that implement this specification SHOULD generally treat TLSA records with certificate usage "0" and a digest matching type as unusable, but MAY be explicitly configured to support them when it is believed that the client posesses a sufficiently complete set of trusted public CA certificates.  This is most plausible with an MUA which only needs enough CA certificates to authenticate its preferred submission service.  </p>
<h1 id="rfc.section.2.2.2"><a href="#rfc.section.2.2.2">2.2.2.</a> Certificate matching</h1>
<p id="rfc.section.2.2.2.p.1">When at least one usable "secure" TLSA record is found, the SMTP client SHOULD use TLSA records to authenticate the next-hop host, mail SHOULD not be delivered via this next-hop host if authentication fails, otherwise the SMTP client is vulnerable to TLS man in the middle attacks.  </p>
<p id="rfc.section.2.2.2.p.2">With TLSA certificate usages "2" or "0" the TLSA base domain SHOULD be the domain the client looks for in the server certificate to check that it has reached the correct server, if the TLSA base domain was obtained indirectly via an MX lookup, the CNAME resolved name used in the MX lookup SHOULD also be accepted.  Barring CNAME expansion, this additional domain is typically the envelope recipient domain, but may be different when the client is an MUA sending all mail to a submission server, or an MTA configured with explicit next-hop destination overrides for the message recipient.  </p>
<p id="rfc.section.2.2.2.p.3">Accepting certificates witih the next-hop domain in addition to the next-hop MX host allows a domain with multiple MX hosts to field a single certificate bearing the email domain name across all the MX hosts, this is also compatible with pre-DANE SMTP clients that are configured to look for the email domain name in server certificates.  </p>
<p id="rfc.section.2.2.2.p.4">The client MUST NOT perform certificate usage name checks with certificate usage "3" (or equivalently "1"), since with these the server is authenticated directly by matching the TLSA RRset to its certificate or public key without resort to any issuing authority.  The certificate content is ignored except in so far as it is used to match the certificate with the TLSA RRset.  </p>
<p id="rfc.section.2.2.2.p.5">To ensure that the server sends the right certificate chain, the SMTP client MUST send the TLS SNI extension containing the TLSA base domain.  Since DANE-aware clients are obligated to send SNI information, which requires at least TLS 1.0, SMTP servers for which DANE TLSA records are published MUST support TLS 1.0 or later with any client authorized to use the service.  </p>
<p id="rfc.section.2.2.2.p.6">Each SMTP server MUST present a certificate trust chain (see <a href="#RFC2246">[RFC2246]</a> Section 7.4.2) that matches at least one of the TLSA records.  The server MAY rely on SNI to determine which certificate chain to present to the client.  Clients that don't send SNI information may not see the expected certificate chain.  </p>
<p id="rfc.section.2.2.2.p.7">If the server's TLSA RRset includes records with a matching type other than "0" (digest records), the SHA-256 digest of any object SHOULD be provided along with any other digest published, since clients may support only SHA-256.  Unless SHA-256 proves vulnerable to a "second preimage" attack, it should be the only digest algorithm used in TLSA records.  </p>
<p id="rfc.section.2.2.2.p.8">If the server's TLSA records match the server's default certificate chain, the server need not support SNI.  The server need not include the extension in its TLS HELLO, simply returning a matching certificate chain is sufficient.  Servers MUST NOT enforce the use of SNI by clients, if the client sends no SNI extension, or sends an SNI extension for an unsupported domain the server MUST simply use its default certificate chain.  The client may be using unauthenticated opportunistic TLS and may not expect any particular certificate from the server.  </p>
<p id="rfc.section.2.2.2.p.9">The client may even offer to use anonymous TLS ciphersuites and servers SHOULD support these, no security is gained by forcing the use of a certificate the client will ignore.  Indeed support for anonymous ciphersuites in the server makes audit trails more useful if the chosen ciphersuite is logged, as this will in many cases record which clients did not care to authenticate the server.  (The Postfix SMTP server supports anonymous TLS ciphersuites by default, and the Postfix SMTP client offers these at its highest preference when server authentication is not applicable).  </p>
<p id="rfc.section.2.2.2.p.10">With opportunistic DANE TLS, both the TLS support implied by the presence of DANE TLSA records and the verification parameters necessary to authenticate the TLS peer are obtained together, therefore authentication via this protocol is expected to be less prone to connection failure caused by incompatible configuration of the client and server.  </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> Opportunistic TLS for Submission</h1>
<p id="rfc.section.3.p.1">Prior to <a href="#RFC6409">[RFC6409]</a> the SMTP submission protocol was poster child for PKIX TLS.  The MUA typically connects to one or sometimes a few submission servers explicitly configured by the user.  There is no indirection via insecure MX records, and unlike the web brower no need to authenticate a large set of TLS servers.  Once TLS is enabled for the desired submission server or servers, provided the server certificate is correctly maintained, the MUA is able to reliably use TLS to authenticate the submission server.  </p>
<p><a href="#RFC6409">[RFC6409]</a> aims to simplify the configuration of the MUA submission service by dynamically deriving the submission service from the user's email address.  This is done via SRV records, but at the cost of introducing the same TLS security problems faced by MTA to MTA SMTP.  Prompting the user when the SRV record domain is different from the email domain is not a robust solution.  </p>
<p id="rfc.section.3.p.3">The protocol proposed in this memo can be used to opportunistically secure the submission service association.  If the email domain is DNSSEC signed, the SRV records are "secure" and the SRV host publishes secure TLSA records for submission, the MUA can safely auto-configure to authenticate the submission server via DANE.  When DANE TLSA records are not available, the client SHOULD fall back to legacy behavior.  </p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> Mandatory TLS Security</h1>
<p id="rfc.section.4.p.1">An MTA implementing this protocol for sending email to the internet at large may need a greater security assurance when sending email to selected destinations to which the sending organization sends sensitive email and may have regulatory obligations to protect its content.  This protocol is not in conflict with this requirement, in fact it can often simplify authenticated delivery to such destinations.  </p>
<p id="rfc.section.4.p.2">Specifically, with domains that publish DANE TLSA records for their MX hosts a sending MTA can be configured to use the receiving domains's DANE TLSA records to authenticate the corresponding MX hosts, thereby obviating a complex manual provisioning process.  In anticipation of or in response to failure to obtain the expected TLSA records the sending system's administrator may choose from a menu of fallback options if supported by the sending MTA: </p>
<p/>

<ul>
  <li>Defer mail if no usable TLSA records are found.  This is useful when the destination is known to publish TLSA records, and lack of TLSA records is most likely a transient misconfiguration.  </li>
  <li>Authenticate the peer via a manually configured certificate digest.  The digest may be a saved copy from a previous successful TLSA lookup, or may be obtained after a problem is detected and confirmed to be valid by some out-of-band mechanism.  </li>
  <li>Authenticate the peer via the existing public CA PKI, if the peer server has usable CA issued certificates.  In many cases the sending MTA will need custom certificate name matching rules to match the destination's gateways.  </li>
  <li>Send via unauthenticated mandatory TLS.  If the requirement is merely to always encrypt, and the possibility of MITM attacks is less of a concern than timely email delivery.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.p.4">It should be noted that barring administrator intervention email SHOULD be deferred when DNSSEC lookups fail, (as distinct from "secure" non-existence of TLSA records, or secure evidence that the domain is no longer signed).  In addition to configuring fallback strategies when TLSA records are unexpectedly absent administrators may in some cases need to disable DNSSEC lookups for a destination to work around a DNSSEC outage.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.5.p.1">Thanks to Tony Finch who finally prodded me into participating in DANE working group discussions. Thanks to Paul Hoffman who motivated me to produce this memo and provided feedback on early drafts.  Thanks also to Wietse Venema who created Postfix, and patiently guided the Postfix DANE implementation to production quality.  </p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#Security" id="Security">Security Considerations</a></h1>
<p id="rfc.section.6.p.1">This protocol leverages DANE TLSA records to implement MITM resistant opportunistic channel security for SMTP.  For destination domains that sign their MX records and publish signed TLSA records for their MX hosts this protocol allows sending MTAs (and perhaps dynamically configured MUAs) to securely discover both the availability of TLS and how to authenticate the destination.  </p>
<p id="rfc.section.6.p.2">This protocol does not aim to secure all SMTP traffic, that will not be practical until DNSSEC and DANE adoption are universal (universal SMTP TLS security via the existing public CA PKI is even less realistic).  The fact that it can be deployed incrementally is a feature, not a bug.  This protocol coexists and interoperates with the existing insecure Internet email backbone, if the protocol proves successful, a growing portion of email traffic will be protected over time.  </p>
<p id="rfc.section.6.p.3">The protocol does not preclude existing non-opportunistic SMTP TLS security arrangements, these can continue as before, or may be used as fallback strategies when this protocol fails to locate the desired security parameters.  </p>
<h1 id="rfc.references"><a href="#rfc.references">7.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2246">[RFC2246]</b>
      </td>
      <td class="top"><a href="mailto:tdierks@certicom.com" title="Certicom">Dierks, T.</a> and <a href="mailto:callen@certicom.com" title="Certicom">C. Allen</a>, "<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>", RFC 2246, January 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3207">[RFC3207]</b>
      </td>
      <td class="top"><a>Hoffman, P.</a>, "<a href="http://tools.ietf.org/html/rfc3207">SMTP Service Extension for Secure SMTP over Transport Layer Security</a>", RFC 3207, February 2002.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3546">[RFC3546]</b>
      </td>
      <td class="top"><a>Blake-Wilson, S.</a>, <a>Nystrom, M.</a>, <a>Hopwood, D.</a>, <a>Mikkelsen, J.</a> and <a>T. Wright</a>, "<a href="http://tools.ietf.org/html/rfc3546">Transport Layer Security (TLS) Extensions</a>", RFC 3546, June 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4033">[RFC4033]</b>
      </td>
      <td class="top"><a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4034">[RFC4034]</b>
      </td>
      <td class="top"><a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>", RFC 4034, March 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4035">[RFC4035]</b>
      </td>
      <td class="top"><a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4035">Protocol Modifications for the DNS Security Extensions</a>", RFC 4035, March 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4346">[RFC4346]</b>
      </td>
      <td class="top"><a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>", RFC 4346, April 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5246">[RFC5246]</b>
      </td>
      <td class="top"><a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5280">[RFC5280]</b>
      </td>
      <td class="top"><a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5321">[RFC5321]</b>
      </td>
      <td class="top"><a>Klensin, J.</a>, "<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>", RFC 5321, October 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6125">[RFC6125]</b>
      </td>
      <td class="top"><a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, March 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6186">[RFC6186]</b>
      </td>
      <td class="top"><a>Daboo, C.</a>, "<a href="http://tools.ietf.org/html/rfc6186">Use of SRV Records for Locating Email Submission/Access Services</a>", RFC 6186, March 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6409">[RFC6409]</b>
      </td>
      <td class="top"><a>Gellens, R.</a> and <a>J. Klensin</a>, "<a href="http://tools.ietf.org/html/rfc6409">Message Submission for Mail</a>", STD 72, RFC 6409, November 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6698">[RFC6698]</b>
      </td>
      <td class="top"><a>Hoffman, P.</a> and <a>J. Schlyter</a>, "<a href="http://tools.ietf.org/html/rfc6698">The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA</a>", RFC 6698, August 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Viktor Dukhovni</span> 
	  <span class="n hidden">
		<span class="family-name">Dukhovni</span>
	  </span>
	</span>
	<span class="org vcardline">Unaffiliated</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ietf-dane@dukhovni.org">ietf-dane@dukhovni.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Wes Hardaker</span> 
	  <span class="n hidden">
		<span class="family-name">Hardaker</span>
	  </span>
	</span>
	<span class="org vcardline">Parsons</span>
	<span class="adr">
	  <span>P.O. Box 382</span>

	  <span class="vcardline">
		<span class="locality">Davis</span>,  
		<span class="region">CA</span> 
		<span class="code">95617</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:hardaker@tislabs.com">hardaker@tislabs.com</a></span>

  </address>
</div>

</body>
</html>